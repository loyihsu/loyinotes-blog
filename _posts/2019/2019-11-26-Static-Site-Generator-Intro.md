---
layout: post
title:  "「靜態網站生成器」 (SSG)，伺服器 out!"
subtitle: "從 ＃蘋果宅 到 Loyinotes"
date:   2019-11-26 20:20:00 +0800
background: 'https://i.imgur.com/yD2Gb26.jpg'
categories: 專案做起來
lang: "zh"
---

大一的時候因為無聊在網路上學了 PHP 做了一個簡單的佈告欄系統，因為想要讓服務上線，就在網路上找附帶資料庫的網頁空間。如果有過這樣的經驗就會發現，有資料庫跟伺服器雖然可以完成大部分的東西，但是一個穩定、免費、安全的資料庫真的是可遇不可求，而租用伺服器/資料庫的成本對於一般人日常的使用成本偏高，還可能需要負擔不必要的風險，例如你的伺服器/資料庫被駭入、資料外流之類的狀況。

> **給麻瓜讀者**：這個「專案做起來」系列筆記主要用途是一個分享我做了什麼專案跟這些專案背後的技術，因為不是教程，可能內容會偏複雜。不過就是因為三言兩語講不完，才值得記錄下來的吧？如果有閱讀上比較困難的地方就簡單看過去吧，反正文章的分塊通常是不太連貫的。

## 資料庫跟伺服器網頁程式

我們日常生活之中最常用到需要資料庫的系統可能是部落格。

部落格的原理就是把你的文章標題、內容存在一個資料庫的一個條目，當有人點到你的那篇文章之上的時候，它就會把那篇文章的標題、內容、分類，甚至是回應調出來。我們通常使用的部落格是掛在提供者的公司的伺服器上，也有一些人會在自家或是租用的伺服器上使用 Wordpress 之類的程式來經營自己的部落格。

但是我們今天要講的東西是完全另一個方向——如果把你的文章存成一個一個的文字檔，然後經由一個程式把你的文字檔跟預先寫好的網頁主題併成一個、一個的網頁檔再上傳，那麼除了回應這類的互動功能有技術上的困難，其餘的部分幾乎可以在沒有資料庫的情況下，把部落格藉由免費的或是任何靜態網頁的網路空間發佈出去。

而上面敘述的這個方式其實就是「靜態網頁生成器」(Static Site Generator, SSG) 的原理。而在開發者們幾乎有在用的 [GitHub](https://github.com) 上有提供 [GitHub Pages](https://github.io) 的網頁空間[^works]，而且支援一個叫做 [Jekyll](https://jekyllrb.com/) 靜態網頁生成器。

![](https://i.imgur.com/0qaQY37.png)

[^works]: 運作方式是每個帳號都有 http://[帳號].github.io 可以免費使用，不同容器 (repository) 也可以變成不同的獨立網頁，放程式碼的容器也可以開一個分枝 (branch) 放（程式介紹）網頁。

基本上 SSG 的材料就是融合了：

* 網頁的基本框框（範本或是主題檔案）
* 你寫的文章（Markdown[^md] 或是 HTML 檔案）
* 你需要的其它客製化

把這三個東西丟進 Jekyll 這個程式裡面，它就可以幫你生成網頁檔。

相對於平常的方式[^norm]，GitHub Page 是可以一次將整個 Jekyll 專案上傳到 GitHub 上，從他們的伺服器幫你生成。

[^md]: Markdown 是一種檔案跟編寫程式的語法，廣泛被應用在 GitHub 上。基本上有點像 HTML，也是一種標記的方式，但是寫起來相對簡單很多，可以用很簡單的記號表示粗體、斜體、標題⋯⋯等等。多數狀況下可以與 HTML 混用。目前這篇文章就是用 Markdown 寫成的。HackMD、CodiMD、Dropbox Paper與一些其它筆記程式也有支援這個格式。

[^norm]: 通常如果沒有特別支援，就是會在本地將網頁本體生成完畢後，直接將生成的結果上傳到網頁空間、伺服器上。

## 不用太深的技術背景也用得了

![](https://i.imgur.com/WEwRx9O.png)

雖然要實現完全的自由度需要你自己寫主題，但是其實你剛創好專案就會有最基礎的主題（如上圖），而且有很多開發主題的人已經預先寫好了很多好用的主題，這些主題可能包含 GitHub 上直接可以切換的預設主題，一些開發者自主開發的主題，當然你要自己寫就是要稍微有網頁開發的經驗，還要稍微研究一下它的原理。

目前這個 Loyinotes 網站的主題是我從 GitHub 上直接拿了一個開發者寫的主題，然後做過一些修改所做出來的客製化主題。

## 簡述一下原理的部分

稍微研究一下它的原理，其實會發現它本身滿直白的。為了不讓說明變得太過複雜，我這邊就很簡單描述一下，不寫出太實作的層面。

如果是一個完全客製化的 Jekyll 基本專案，檔案架構大概是這樣：

* \_config.yml (**一些網站的基本設定（如：網站標題、作者名字⋯⋯等等）**)
* \_drafts (**放草稿的地方**)
    * my-draft.md
* \_includes (**放實作的地方（通常是會一直重複的部分）**)
    * footer.html
    * header.html
* \_layouts (**放模板架構的地方**)
    * default.html
    * post.html
* \_posts (**放文章的地方**)
    * 2019-11-26-my-post.md
* \_sass (**放客製化樣式表（如 CSS 檔）的地方**)
    * _base.scss
    * _layout.scss
* \_site (**生成的網站**)
* index.html (**首頁檔**)

如果你沒有要做太大的更動，創好專案之後只要改改 \_config 檔，在 \_posts、\_drafts 裡面放放文章（用 markdown 寫) 就夠了。如果你要做一些基本的更動，那就會動到 _includes 和 _layouts 了。

因為一個網頁通常的架構是這樣：

![Code](https://i.imgur.com/sSKAvdp.png)

在最基礎的架構上就可以寫成：

![Code](https://i.imgur.com/8mdS39J.png)

只要把這個東西叫做 default.html 放在 \_layout 資料夾中。再在專案中的 \_includes 資料夾補上 head.html、navigation.html、footer.html 這些檔案跟實作，基本上就會在上面  **include** 的地方插入。

而只要把這些東西稍微自己變化一下、變成自己想要的形式，要寫出自己的主題、甚至是變成自己的網頁也不會太困難。

因為要在這邊三言兩語講完全部的細節幾乎不可能，這邊先附上這個部落格的原始碼 （[loyihsu/loyinotes-blog](https://github.com/loyihsu/loyinotes-blog))，有興趣的可以稍微看一下這個部落格是怎麼做出來的，之後做好 Jekyll 版本的 Loyiworks 網頁可能也會另外放上來。

## 沒事做自己的專案的好處：累積的過程

一開始 Loyinotes 用的專案其實是我在做[「＃蘋果宅」](https://otaku-blog.loyi.dev/) 的時候，在 GitHub 上找到的主題變化出來的客製化主題（[BlackrockDigital/startbootstrap-clean-blog-jekyll](https://github.com/BlackrockDigital/startbootstrap-clean-blog-jekyll)）。在「＃蘋果宅」的時期，我先是把這個主題翻譯成中文、做成夜晚模式，也加入一些我需要的分類功能。而這次在製作 Loyinotes 的版本的時候我也把年份的功能給實作好了。而這些東西的過程除了怎麼把文章列出來要研究一下 Jekyll 怎麼寫（有一個主題可以參考的話很快就可以寫得出來了，基本就是告訴它你要在哪裡列出什麼東西而已），其它就是跟設計網頁很像。

而最近我發現其實我自己有一個習慣是，我很喜歡做這些專案，而且在做這些專案的時候，我其實很常會挪用以前做其它專案時的經驗或成果。也就是說，其實有時候最後被用來做某個專案的東西，在一開始設計的時候真的只是好玩，然後愈做愈大，有一些可能直接變成了一個獨立的程式、專案，有一些則可能被挪用到另一個專案中，變成那個專案的基底（之一）。舉例來說這個 Loyinotes 專案背後包含以前玩 Jekyll、大二的時候玩 [Bootstrap](https://getbootstrap.com/) 跟用它寫[第29屆月涵文學獎的網頁](https://yuehan29.github.io)、跟為「＃蘋果宅」客製化主題的經驗，綜合起來變成的。

我覺得這其實就是了 Jobs 那句，「點跟點的連結只能靠著後見之明」背後的深意。**如果你從來沒有做過的東西，它們是永遠不會變成你做另一個東西的基底的；同時，你做過的東西都不會白費，因為你在做的時候學到的東西，很容易就會變成你做另一個新東西時會用到的養分。**
